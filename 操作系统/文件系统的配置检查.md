

1. ### 挂载并当前使用了多少个文件系统？

   ```shell
   df -h
   df -MB
   df -i
   ```

2. ### 文件系统记录大小？

   ```shell
   du -sh
   ```

3. ### 启用了访问时间戳吗？

   要查看CentOS中文件系统是否启用了访问时间戳（atime），可以使用`mount`命令。

   1. 打开终端。
   2. 运行以下命令：
      ```bash
      mount | grep " / "
      ```
      这将列出挂载在根文件系统上的相关信息。
   3. 在输出中查找根文件系统的行，通常是以 `/` 结尾的行。该行中的选项列（Options column）将包含有关文件系统挂载选项的信息。
   4. 在选项列中查找是否包含 `noatime` 或 `relatime`。
      - 如果选项列中包含 `noatime`，则表示文件系统已禁用访问时间戳。这意味着访问文件时不会更新文件的访问时间。
      - 如果选项列中包含 `relatime`，则表示文件系统处于相对更新模式。这意味着访问文件时会更新文件的访问时间，但只在访问时间早于修改时间或创建时间时才会更新。
      - 如果选项列中没有出现 `noatime` 或 `relatime`，则文件系统启用了完整的访问时间戳更新。

   请注意，`mount` 命令需要以管理员（root）权限运行，你可以使用 `sudo mount | grep " / "` 命令来获取权限。

   需要说明的是，禁用访问时间戳（使用 `noatime` 或 `relatime`）可以提高文件系统的性能，尤其是对于大量读取操作的文件系统。然而，某些应用程序可能依赖于访问时间戳来追踪文件的最后访问时间。因此，在禁用访问时间戳之前，请确保了解相关应用程序的需求和影响。

4. ### 还启用了哪些文件系统选项（压缩、加密等）？

   要查看文件系统在CentOS中启用了哪些文件系统选项（如压缩、加密等），可以使用 `mount` 命令。

   1. 打开终端。
   2. 运行以下命令：
      ```bash
      mount | grep " / "
      ```
      这将列出挂载在根文件系统上的相关信息。
   3. 在输出中查找根文件系统的行，通常是以 `/` 结尾的行。该行中的选项列（Options column）将包含有关文件系统挂载选项的信息。
   4. 在选项列中查找与文件系统选项相关的标识。
      - 压缩选项：可能使用 `compress` 或 `zlib` 标识。例如，`compress=zlib` 表示启用了Zlib压缩。
      - 加密选项：可能使用 `encrypt`、`encrypted` 或 `crypt` 标识。例如，`encrypt` 表示启用了加密。
      - 其他选项：根据文件系统的特定选项，可能会有其他标识。

   需要注意的是，`mount` 命令需要以管理员（root）权限运行，你可以使用 `sudo mount | grep " / "` 命令来获取权限。

   请注意，不同的文件系统可能具有不同的选项，并且某些选项可能需要特定的内核模块或文件系统工具来支持。因此，确保你已正确安装和配置相关的软件和驱动程序，以使这些选项生效。

   另外，不同的文件系统类型具有不同的特性和选项，因此要查看特定文件系统类型的选项，可以在 `mount` 命令中指定文件系统类型。例如，要查看ext4文件系统的选项，可以运行以下命令：
   ```bash
   mount -t ext4 | grep " / "
   ```

5. ### 文件系统缓存是怎么配置的？最大缓存大小是多少？

   文件系统缓存的配置和最大缓存大小在CentOS中是由内核参数决定的。下面是一些与文件系统缓存相关的重要参数：

   1. `vm.dirty_background_bytes`：指定脏数据（已被修改但尚未写入磁盘）的阈值。当脏数据超过该阈值时，后台进程会开始写入脏数据到磁盘。

   2. `vm.dirty_bytes`：指定脏数据的最大阈值。当脏数据超过该阈值时，进程将被阻塞，直到脏数据的一部分被写入磁盘。

   3. `vm.dirty_ratio`：指定脏数据与总系统内存的比例阈值。当脏数据达到或超过该比例时，进程将被阻塞，直到脏数据的一部分被写入磁盘。

   4. `vm.dirty_background_ratio`：指定后台进程开始写入脏数据的比例阈值。

   这些参数的值可以在 `/proc/sys/vm/` 目录下的相应文件中进行查询和修改。例如，要查看和修改 `vm.dirty_background_bytes` 参数，可以执行以下命令：

   - 查看参数值：
     ```bash
     cat /proc/sys/vm/dirty_background_bytes
     ```

   - 修改参数值（需要管理员权限）：
     ```bash
     echo 4194304 > /proc/sys/vm/dirty_background_bytes
     ```

   最大缓存大小（文件系统缓存的最大使用空间）不是一个单独的参数，而是由系统内存的可用空间和文件系统缓存参数共同决定。当文件系统缓存中的数据超过一定阈值时，内核会根据需要释放缓存以保持系统的稳定性。

   要了解当前文件系统缓存的使用情况，可以使用 `free` 或 `top` 命令来查看系统内存的使用情况，包括缓存的大小。例如，运行以下命令以查看 `free` 命令的输出：
   ```bash
   free -h
   ```

   请注意，文件系统缓存的行为和性能可以受到多个因素的影响，包括文件系统类型、I/O调度程序、磁盘性能、系统负载等。因此，在调整文件系统缓存配置之前，建议进行详细的性能分析和测试，以确定最适合你的特定环境和需求的配置。

6. ### 其他缓存（目录、inode、高速缓冲区）是怎么配置的？

   在CentOS中，除了文件系统缓存，还有其他几种常见的缓存配置：目录缓存（dentry cache）、iNode 缓存（inode cache）和页缓存（page cache）。这些缓存可以通过调整内核参数进行配置。

   以下是与这些缓存相关的一些重要参数：

   1. 目录缓存（dentry cache）：
      - `vm.vfs_cache_pressure`：指定内核在释放目录缓存之前，对目录缓存和页缓存的内存压力权衡。较高的值更倾向于释放目录缓存。
      - `fs.dir-notify-enable`：启用或禁用目录通知机制，用于在目录缓存中跟踪目录的更改。

   2. iNode 缓存（inode cache）：
      - `vm.vfs_cache_pressure`：同样适用于释放iNode缓存。较高的值更倾向于释放iNode缓存。

   3. 页缓存（page cache）：
      - `vm.dirty_background_bytes`：指定脏数据（尚未写入磁盘）的阈值。
      - `vm.dirty_bytes`：指定脏数据的最大阈值。
      - `vm.dirty_ratio`：指定脏数据与总系统内存的比例阈值。
      - `vm.dirty_background_ratio`：指定后台进程开始写入脏数据的比例阈值。

   这些参数的值可以在 `/proc/sys/` 目录下的相应文件中进行查询和修改。例如，要查看和修改 `vm.vfs_cache_pressure` 参数，可以执行以下命令：

   - 查看参数值：
     ```bash
     cat /proc/sys/vm/vfs_cache_pressure
     ```

   - 修改参数值（需要管理员权限）：
     ```bash
     echo 100 > /proc/sys/vm/vfs_cache_pressure
     ```

   请注意，在调整这些缓存配置之前，建议进行详细的性能分析和测试，以确定最适合你的特定环境和需求的配置。此外，对于某些参数，较低或较高的值可能会对系统性能产生负面影响，因此谨慎地进行调整和评估。

7. ### 有二级缓存吗？用了吗？

   在Linux系统中，你可以使用以下方法来查看二级缓存是否被使用：

   1. 使用 `lscpu` 命令：
      - 打开终端并输入 `lscpu` 命令。
      - 在输出中查找 "L2 缓存" 或类似的行，其中将显示 L2 缓存的大小和一些其他相关信息。如果 L2 缓存的大小显示为非零值，则表示二级缓存被使用。

   2. 使用 `/sys/devices/system/cpu/cpu*/cache/index2/` 路径：
      - 打开终端。
      - 进入 `/sys/devices/system/cpu/` 目录：`cd /sys/devices/system/cpu/`
      - 使用以下命令来检查每个 CPU 的二级缓存是否存在：
        ```bash
        ls cpu*/cache/index2/
        ```
      - 如果目录存在，则表示该 CPU 上的二级缓存被使用。

   请注意，这些方法仅适用于检查硬件层面上的二级缓存是否存在和被使用。操作系统和应用程序会自动利用这些硬件缓存层次来提高数据访问性能，而无需进行额外的配置或操作。

   如果你想进行更深入的缓存性能分析，可以使用专业的性能分析工具，如 `perf`、`valgrind` 等，来获取更详细的缓存使用和性能统计信息。

8. ### 有多少个存储设备？用了几个？

   在 CentOS 中，你可以使用以下方法来查看有多少个存储设备，并确定有多少个存储设备被使用：

   1. 使用 `lsblk` 命令：
      - 打开终端并输入 `lsblk` 命令。
      - `lsblk` 命令将显示系统中所有的块设备（包括存储设备和分区）以树状结构列出。
      - 查找磁盘设备（通常以字母 `sd` 开头，如 `/dev/sda`、`/dev/sdb` 等）的数量，并计算总数以确定有多少个存储设备。

   2. 使用 `lsscsi` 命令：
      - 打开终端并输入 `lsscsi` 命令。
      - `lsscsi` 命令将显示系统中的 SCSI 设备列表，包括磁盘设备。
      - 查找磁盘设备的数量，并计算总数以确定有多少个存储设备。

   3. 使用 `/proc/partitions` 文件：
      - 打开终端并输入以下命令查看文件内容：
        ```bash
        cat /proc/partitions
        ```
      - `/proc/partitions` 文件将列出系统中的块设备及其分区。
      - 查找磁盘设备的数量，并计算总数以确定有多少个存储设备。

   请注意，这些方法将告诉你有多少个存储设备在系统中可用，但不能确定有多少个存储设备正在被使用。要确定实际使用了多少个存储设备，需要考虑挂载点、文件系统和其他相关信息。

   你可以使用命令如 `lsblk -f`、`df -h` 等来查看已挂载的文件系统以及它们所在的存储设备。这些命令将提供有关每个存储设备的使用情况。

9. ### 存储设备是怎么配置的？用了RAID 吗？

   在 CentOS 中，你可以使用以下方法来查看存储设备的配置和是否使用了 RAID：

   1. 使用 `lsblk` 命令：
      - 打开终端并输入 `lsblk` 命令。
      - `lsblk` 命令将显示系统中所有的块设备（包括存储设备和分区）以树状结构列出。
      - 查找存储设备的名称（通常以字母 `sd` 开头，如 `/dev/sda`、`/dev/sdb` 等）。
      - 对于每个存储设备，可以查看其大小、分区情况以及是否属于 RAID 配置。

   2. 使用 `cat /proc/mdstat` 命令：
      - 打开终端并输入以下命令查看文件内容：
        ```bash
        cat /proc/mdstat
        ```
      - 如果系统中使用了软件 RAID，`/proc/mdstat` 文件将显示 RAID 配置的详细信息，包括 RAID 设备的名称、级别（如 RAID 0、RAID 1 等）以及成员设备。
      - 如果没有输出或者输出为空，表示系统中没有使用软件 RAID。

   3. 使用工具如 `mdadm`：
      - `mdadm` 是用于管理 Linux 软件 RAID 的命令行工具。
      - 输入 `mdadm --detail /dev/mdX` 命令，将 `/dev/mdX` 替换为实际的 RAID 设备名称，可以查看特定 RAID 设备的详细信息，包括成员设备、RAID 级别和状态等。

   请注意，这些方法主要适用于检查软件 RAID 配置。如果系统中使用了硬件 RAID 控制器，你可能需要查看硬件 RAID 控制器的相关文档或使用特定的管理工具来查看存储设备的配置和 RAID 状态。

   另外，如果你有 root 权限，还可以查看 `/etc/fstab` 文件来了解系统中的挂载点和文件系统配置，这可以提供关于存储设备使用的更多信息。

10. ### 用了哪种文件系统？

    在 CentOS 中，你可以使用以下方法来查看系统中使用的文件系统：

    1. 使用 `df -T` 命令：
       - 打开终端并输入 `df -T` 命令。
       - `df -T` 命令将显示系统中已挂载的文件系统以及它们所使用的文件系统类型。
       - 查找你感兴趣的挂载点（如根目录 `/`、`/home` 等）并查看相应的文件系统类型。

    2. 使用 `mount` 命令：
       - 打开终端并输入 `mount` 命令。
       - `mount` 命令将显示系统中已挂载的文件系统信息。
       - 查找你感兴趣的挂载点并查看相应的文件系统类型。

    3. 查看 `/etc/fstab` 文件：
       - 打开终端，并使用以下命令来查看 `/etc/fstab` 文件的内容：
         ```bash
         cat /etc/fstab
         ```
       - `/etc/fstab` 文件包含了系统中挂载点和文件系统配置的信息。
       - 查找你感兴趣的挂载点，并查看对应的文件系统类型。

    这些方法将提供有关系统中每个挂载点所使用的文件系统类型的信息。常见的文件系统类型包括 ext4、XFS、NTFS、FAT32 等。

11. ### 用了哪个文件系统的版本（或者内核）？

    要查看 CentOS 中使用的文件系统版本和内核版本，可以使用以下方法：

    1. 查看文件系统版本：
       - 对于 ext4 文件系统，你可以使用以下命令来查看文件系统的版本：
         ```bash
         sudo tune2fs -l /dev/<device>
         ```
         将 `<device>` 替换为实际的设备名称，如 `/dev/sda1`。在输出中，你可以找到 "Filesystem features" 或类似的部分，其中包含文件系统的版本信息。

       - 对于 XFS 文件系统，你可以使用以下命令来查看文件系统的版本：
         ```bash
         sudo xfs_info /dev/<device>
         ```
         将 `<device>` 替换为实际的设备名称，如 `/dev/sda1`。在输出中，你可以找到 "meta-data" 或类似的部分，其中包含文件系统的版本信息。

    2. 查看内核版本：
       - 使用以下命令来查看当前运行的内核版本：
         ```bash
         uname -r
         ```
         这将输出当前系统使用的内核版本。

       - 若要查看完整的内核信息，可以使用以下命令：
         ```bash
         uname -a
         ```
         这将输出包括内核版本、主机名、操作系统版本等详细信息。

    通过上述方法，你可以快速查看 CentOS 中使用的文件系统版本和内核版本。

12. ### 有什么需要考虑的文件系统bug/补丁？

13. ### 启用文件系统I/O 的资源控制了吗？

    在 CentOS 中，启用文件系统I/O的资源控制通常涉及使用cgroup（控制组）和blkio（块I/O）子系统来限制文件系统I/O的资源使用。这可以通过以下步骤来检查是否已启用文件系统I/O的资源控制：

    1. 检查cgroup和blkio子系统是否可用：
       - 打开终端并运行以下命令：
         ```bash
         mount | grep cgroup
         ```
       - 检查输出中是否包含类似于 `cgroup on /sys/fs/cgroup/blkio type cgroup` 的行。如果有这样的行，说明cgroup和blkio子系统已启用。

    2. 检查blkio控制组是否存在并配置：
       - 进入 `/sys/fs/cgroup/blkio/` 目录：
         ```bash
         cd /sys/fs/cgroup/blkio/
         ```
       - 使用以下命令检查是否存在名为 `blkio.throttle.read_bps_device` 和 `blkio.throttle.write_bps_device` 的文件：
         ```bash
         ls -l
         ```
       - 如果这些文件存在，说明blkio控制组已配置。

    如果cgroup和blkio子系统可用，且blkio控制组已配置，那么文件系统I/O的资源控制就已启用。你可以在这些控制组文件中配置和调整文件系统I/O的限制，以限制其使用的资源。

    请注意，启用和配置文件系统I/O资源控制需要管理员权限。此外，某些情况下，系统可能未启用文件系统I/O资源控制，或者使用其他方式来管理和限制文件系统I/O的资源使用。因此，具体的配置和设置可能因系统配置而异。

